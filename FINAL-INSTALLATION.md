# راهنمای نصب نهایی - حل همه مشکلات

## ⚠️ مشکل "Class declarations may not be nested"

این خطا به خاطر استفاده از فایل‌های قدیمی است که کلاس‌های تو در تو دارند.

## ✅ راه‌حل قطعی:

### گام 1: پاک‌سازی کامل
1. به **افزونه‌ها** بروید
2. **تمام نسخه‌های قبلی** را غیرفعال کنید
3. آن‌ها را **حذف** کنید
4. پوشه `/wp-content/plugins/wp-direct-plugin-installer-main/` را **کاملاً حذف** کنید

### گام 2: نصب نسخه ساده
1. فایل `plugin-installer-simple.php` را دانلود کنید
2. آن را در `/wp-content/plugins/` آپلود کنید
3. به **افزونه‌ها** بروید
4. افزونه **"نصب افزونه با لینک (نسخه ساده)"** را فعال کنید

### گام 3: تست
1. به **افزونه‌ها > افزودن** بروید
2. دکمه **"افزودن با لینک"** را مشاهده کنید
3. روی آن کلیک کنید
4. این لینک را تست کنید:
```
https://downloads.wordpress.org/plugin/hello-dolly.1.7.2.zip
```

## 🎯 مزایای نسخه ساده:

✅ **بدون کلاس nested** - هیچ خطای PHP نخواهید دید  
✅ **ساده و سریع** - فقط کدهای ضروری  
✅ **سازگار با همه نسخه‌های PHP** - حتی قدیمی‌ترها  
✅ **بدون dependency** - استفاده از کلاس‌های پیش‌فرض وردپرس  
✅ **UI زیبا** - طراحی مطابق با استانداردهای وردپرس  

## 🔧 در صورت ادامه مشکل:

### 1. مشکل مجوزها:
به `wp-config.php` اضافه کنید:
```php
define('FS_METHOD', 'direct');
define('DISALLOW_FILE_MODS', false);
```

### 2. مشکل حافظه:
```php
ini_set('memory_limit', '512M');
ini_set('max_execution_time', 300);
```

### 3. مشکل شبکه:
```php
add_filter('http_request_args', function($args) {
    $args['sslverify'] = false;
    return $args;
});
```

## 📋 چک لیست نهایی:

- [ ] تمام نسخه‌های قدیمی حذف شده
- [ ] فایل `plugin-installer-simple.php` آپلود شده
- [ ] افزونه فعال شده
- [ ] دکمه "افزودن با لینک" نمایان است
- [ ] تست با لینک hello-dolly موفق بوده

## 🎉 تبریک!

اگر همه مراحل بالا را انجام دادید، افزونه حالا کاملاً کار می‌کند و می‌توانید:

- ✅ افزونه‌ها را از طریق URL نصب کنید
- ✅ از رابط کاربری زیبا استفاده کنید  
- ✅ پیشرفت نصب را مشاهده کنید
- ✅ پیام‌های خطا و موفقیت دریافت کنید

**نکته:** این نسخه ساده بوده و همه خطاهای قبلی را رفع کرده است.